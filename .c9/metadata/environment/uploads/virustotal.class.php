{"filter":false,"title":"virustotal.class.php","tooltip":"/uploads/virustotal.class.php","undoManager":{"mark":16,"position":16,"stack":[[{"start":{"row":280,"column":2},"end":{"row":280,"column":3},"action":"insert","lines":["p"],"id":51}],[{"start":{"row":280,"column":3},"end":{"row":280,"column":4},"action":"insert","lines":["u"],"id":52}],[{"start":{"row":280,"column":4},"end":{"row":280,"column":5},"action":"insert","lines":["b"],"id":53}],[{"start":{"row":280,"column":5},"end":{"row":280,"column":6},"action":"insert","lines":["l"],"id":54}],[{"start":{"row":280,"column":6},"end":{"row":280,"column":7},"action":"insert","lines":["i"],"id":55}],[{"start":{"row":280,"column":7},"end":{"row":280,"column":8},"action":"insert","lines":["c"],"id":56}],[{"start":{"row":280,"column":8},"end":{"row":280,"column":9},"action":"insert","lines":[" "],"id":57}],[{"start":{"row":247,"column":2},"end":{"row":247,"column":3},"action":"insert","lines":["p"],"id":58}],[{"start":{"row":247,"column":3},"end":{"row":247,"column":4},"action":"insert","lines":["u"],"id":59}],[{"start":{"row":247,"column":4},"end":{"row":247,"column":5},"action":"insert","lines":["b"],"id":60}],[{"start":{"row":247,"column":5},"end":{"row":247,"column":6},"action":"insert","lines":["l"],"id":61}],[{"start":{"row":247,"column":6},"end":{"row":247,"column":7},"action":"insert","lines":["i"],"id":62}],[{"start":{"row":247,"column":7},"end":{"row":247,"column":8},"action":"insert","lines":["c"],"id":63}],[{"start":{"row":247,"column":8},"end":{"row":247,"column":9},"action":"insert","lines":[" "],"id":64}],[{"start":{"row":280,"column":2},"end":{"row":280,"column":9},"action":"remove","lines":["public "],"id":65}],[{"start":{"row":247,"column":2},"end":{"row":247,"column":9},"action":"remove","lines":["public "],"id":66}],[{"start":{"row":247,"column":2},"end":{"row":307,"column":3},"action":"remove","lines":["function VirusTotalFileCheck($path){  ","    $file_name_with_full_path = realpath($path);","    $api_key = getenv('VT_API_KEY') ? getenv('VT_API_KEY') :'62ce324bb90c77befcd8c11b46869b2c8274e81544de94d9896e3ea6497c1826';","    $cfile = curl_file_create($file_name_with_full_path);","     ","    $post = array('apikey' => $api_key,'file'=> $cfile);","    $ch = curl_init();","    curl_setopt($ch, CURLOPT_URL, 'https://www.virustotal.com/vtapi/v2/file/scan');","    curl_setopt($ch, CURLOPT_POST, True);","    curl_setopt($ch, CURLOPT_VERBOSE, 1); // remove this if your not debugging","    curl_setopt($ch, CURLOPT_ENCODING, 'gzip,deflate'); // please compress data","    curl_setopt($ch, CURLOPT_USERAGENT, \"gzip, My php curl client\");","    curl_setopt($ch, CURLOPT_RETURNTRANSFER ,True);","    curl_setopt($ch, CURLOPT_POSTFIELDS, $post);","     ","    $result=curl_exec ($ch);","    $status_code = curl_getinfo($ch, CURLINFO_HTTP_CODE);","    print(\"status = $status_code\\n\");","    if ($status_code == 200) { // OK","      $js = json_decode($result, true);","      echo \"<pre>\";","      print_r($js);","      echo \"<br>\";","      echo \"responce code: \".$js[\"response_code\"].\"<br>\";","      if($js[\"response_code\"]==1)echo\"not present in VirusTotal's dataset\";","      if($js[\"response_code\"]==0)echo\"present and it could be retrieved\";","      if($js[\"response_code\"]==-2)echo\"still queued for analysis\";","    } else {  // Error occured","      print($result);","    }","    curl_close ($ch);","  }","  ","  function VirusTotalCheckHashOfSubmitedFile($hash){","    $post = array('apikey' => '62ce324bb90c77befcd8c11b46869b2c8274e81544de94d9896e3ea6497c1826','resource'=>$hash);","    $ch = curl_init();","    curl_setopt($ch, CURLOPT_URL, 'https://www.virustotal.com/vtapi/v2/file/report');","    curl_setopt($ch, CURLOPT_POST,1);","    curl_setopt($ch, CURLOPT_ENCODING, 'gzip,deflate'); // please compress data","    curl_setopt($ch, CURLOPT_USERAGENT, \"gzip, My php curl client\");","    curl_setopt($ch, CURLOPT_VERBOSE, 1); // remove this if your not debugging","    curl_setopt($ch, CURLOPT_RETURNTRANSFER ,true);","    curl_setopt($ch, CURLOPT_POSTFIELDS, $post);","     ","    $result = curl_exec ($ch);","    $status_code = curl_getinfo($ch, CURLINFO_HTTP_CODE);","    //print(\"status = $status_code\\n\");","    if ($status_code == 200) { // OK","      $js = json_decode($result, true);","      echo \"<pre>\";","      print_r($js);","      if($js[\"positives\"]==0){","        return true;","      }else{","        return false;","      }","    } else {  // Error occured","      print($result);","    }","    curl_close ($ch);","  }"],"id":67}]]},"ace":{"folds":[],"scrolltop":3468,"scrollleft":0,"selection":{"start":{"row":247,"column":2},"end":{"row":247,"column":2},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":{"row":230,"state":"php-doc-start","mode":"ace/mode/php"}},"timestamp":1522170077107,"hash":"a1bcbffdd86992904ccdf5d8e69ee1f5b76f3e68"}