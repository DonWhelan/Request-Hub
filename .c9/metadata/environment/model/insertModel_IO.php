{"filter":false,"title":"insertModel_IO.php","tooltip":"/model/insertModel_IO.php","undoManager":{"mark":18,"position":18,"stack":[[{"start":{"row":0,"column":0},"end":{"row":0,"column":1},"action":"insert","lines":["<"],"id":1},{"start":{"row":0,"column":1},"end":{"row":0,"column":2},"action":"insert","lines":["?"]},{"start":{"row":0,"column":2},"end":{"row":0,"column":3},"action":"insert","lines":["p"]},{"start":{"row":0,"column":3},"end":{"row":0,"column":4},"action":"insert","lines":["h"]},{"start":{"row":0,"column":4},"end":{"row":0,"column":5},"action":"insert","lines":["p"]}],[{"start":{"row":0,"column":5},"end":{"row":1,"column":0},"action":"insert","lines":["",""],"id":2},{"start":{"row":1,"column":0},"end":{"row":2,"column":0},"action":"insert","lines":["",""]}],[{"start":{"row":2,"column":0},"end":{"row":67,"column":5},"action":"insert","lines":["","    /*","     *   insert_prepared_imageUpload takes 6 arguments and querys a prepaired statment to call images","     *   exacutes the query and the takes the affeted rows","     *   checks the affected rows agains the expected rows","     *   returns true if affected rows are equal expected rows they match, and false if not","     */     ","    ","    function insert_prepared_imageUpload($dir, $ufilename, $uhash, $uowner, $uvirusFree, $expectedResult) {","        $connection = insertConnectionString($dir);","        // Check connection","        if ($connection->connect_error) {","            die(\"Connection failed: \" . $connection->connect_error);","        }","        $stmt = $connection->prepare(\"INSERT INTO images (filename, hash, owner, virusFree) VALUES (?,?,?,?)\");","        $filename = $ufilename;","        $hash = $uhash;","        $owner = $uowner;","        $virusFree = $uvirusFree;","        $stmt->bind_param(\"ssss\", $filename, $hash, $owner, $virusFree);","        $stmt->execute();","        $affectedRows = mysqli_stmt_affected_rows($stmt);","        // check expected result","        if($affectedRows != $expectedResult){","            //include(\"logs/logsMail.php\");","            return false;","        }else{","            return true;","        }","    }   ","    ","    /*","     *   insert_prepared_imageUploadTransaction takes 6 arguments and querys a prepaired statment to call images","     *   starts a transaction, exacutes the query and the takes the affeted rows","     *   checks the affected rows agains the expected rows","     *   returns true and commits the transaction if affected rows are equal, expected rows they match, and false and rolls back if not","     */ ","        ","    function insert_prepared_imageUploadTransaction($dir, $ufilename, $uhash, $uowner, $uvirusFree, $expectedResult) {","        $connection = insertConnectionString($dir);","        mysqli_autocommit($connection,FALSE);","        mysqli_query($connection,\"start transaction\"); ","        ","        // Check connection","        if ($connection->connect_error) {","            die(\"Connection failed: \" . $connection->connect_error);","        }","        $stmt = $connection->prepare(\"INSERT INTO images (filename, hash, owner, virusFree) VALUES (?,?,?,?)\");","        $filename = $ufilename;","        $hash = $uhash;","        $owner = $uowner;","        $virusFree = $uvirusFree;","        $stmt->bind_param(\"ssss\", $filename, $hash, $owner, $virusFree);","        $stmt->execute();","        $affectedRows = mysqli_stmt_affected_rows($stmt);","        // check expected result","        if($affectedRows != $expectedResult){","            //include(\"logs/logsMail.php\");","            mysqli_query($connection,\"rollback\");","            return false;","        }else{","            mysqli_query($connection,\"commit\");","            return true;","        }","        mysqli_close($connection);","    }"],"id":3}],[{"start":{"row":67,"column":5},"end":{"row":68,"column":0},"action":"insert","lines":["",""],"id":4},{"start":{"row":68,"column":0},"end":{"row":68,"column":4},"action":"insert","lines":["    "]},{"start":{"row":68,"column":4},"end":{"row":69,"column":0},"action":"insert","lines":["",""]},{"start":{"row":69,"column":0},"end":{"row":69,"column":4},"action":"insert","lines":["    "]},{"start":{"row":69,"column":4},"end":{"row":69,"column":5},"action":"insert","lines":["?"]},{"start":{"row":69,"column":5},"end":{"row":69,"column":6},"action":"insert","lines":[">"]}],[{"start":{"row":69,"column":0},"end":{"row":69,"column":4},"action":"remove","lines":["    "],"id":5}],[{"start":{"row":13,"column":41},"end":{"row":14,"column":0},"action":"insert","lines":["",""],"id":6},{"start":{"row":14,"column":0},"end":{"row":14,"column":12},"action":"insert","lines":["            "]}],[{"start":{"row":14,"column":12},"end":{"row":14,"column":91},"action":"insert","lines":["error_log(\"unable to connect! insert_prepared_companyUploadTransaction(),\", 0);"],"id":7}],[{"start":{"row":14,"column":42},"end":{"row":14,"column":83},"action":"remove","lines":["insert_prepared_companyUploadTransaction("],"id":8},{"start":{"row":14,"column":42},"end":{"row":14,"column":70},"action":"insert","lines":["insert_prepared_imageUpload("]}],[{"start":{"row":27,"column":12},"end":{"row":27,"column":43},"action":"remove","lines":["//include(\"logs/logsMail.php\");"],"id":9},{"start":{"row":27,"column":12},"end":{"row":27,"column":78},"action":"insert","lines":["error_log(\"unable to connect! insert_prepared_imageUpload(),\", 0);"]}],[{"start":{"row":27,"column":23},"end":{"row":27,"column":40},"action":"remove","lines":["unable to connect"],"id":10},{"start":{"row":27,"column":23},"end":{"row":27,"column":24},"action":"insert","lines":["i"]},{"start":{"row":27,"column":24},"end":{"row":27,"column":25},"action":"insert","lines":["n"]},{"start":{"row":27,"column":25},"end":{"row":27,"column":26},"action":"insert","lines":["e"]},{"start":{"row":27,"column":26},"end":{"row":27,"column":27},"action":"insert","lines":["x"]},{"start":{"row":27,"column":27},"end":{"row":27,"column":28},"action":"insert","lines":["p"]},{"start":{"row":27,"column":28},"end":{"row":27,"column":29},"action":"insert","lines":["e"]},{"start":{"row":27,"column":29},"end":{"row":27,"column":30},"action":"insert","lines":["c"]},{"start":{"row":27,"column":30},"end":{"row":27,"column":31},"action":"insert","lines":["t"]},{"start":{"row":27,"column":31},"end":{"row":27,"column":32},"action":"insert","lines":["e"]},{"start":{"row":27,"column":32},"end":{"row":27,"column":33},"action":"insert","lines":["d"]}],[{"start":{"row":27,"column":33},"end":{"row":27,"column":34},"action":"insert","lines":[" "],"id":11},{"start":{"row":27,"column":34},"end":{"row":27,"column":35},"action":"insert","lines":["r"]},{"start":{"row":27,"column":35},"end":{"row":27,"column":36},"action":"insert","lines":["e"]},{"start":{"row":27,"column":36},"end":{"row":27,"column":37},"action":"insert","lines":["s"]},{"start":{"row":27,"column":37},"end":{"row":27,"column":38},"action":"insert","lines":["u"]},{"start":{"row":27,"column":38},"end":{"row":27,"column":39},"action":"insert","lines":["l"]},{"start":{"row":27,"column":39},"end":{"row":27,"column":40},"action":"insert","lines":["t"]}],[{"start":{"row":47,"column":41},"end":{"row":48,"column":0},"action":"insert","lines":["",""],"id":12},{"start":{"row":48,"column":0},"end":{"row":48,"column":12},"action":"insert","lines":["            "]}],[{"start":{"row":48,"column":12},"end":{"row":48,"column":78},"action":"insert","lines":["error_log(\"unable to connect! insert_prepared_imageUpload(),\", 0);"],"id":13}],[{"start":{"row":48,"column":42},"end":{"row":48,"column":70},"action":"remove","lines":["insert_prepared_imageUpload("],"id":14},{"start":{"row":48,"column":42},"end":{"row":48,"column":81},"action":"insert","lines":["insert_prepared_imageUploadTransaction("]}],[{"start":{"row":61,"column":12},"end":{"row":61,"column":43},"action":"remove","lines":["//include(\"logs/logsMail.php\");"],"id":15},{"start":{"row":61,"column":12},"end":{"row":61,"column":89},"action":"insert","lines":["error_log(\"unable to connect! insert_prepared_imageUploadTransaction(),\", 0);"]}],[{"start":{"row":61,"column":26},"end":{"row":61,"column":40},"action":"remove","lines":["ble to connect"],"id":16},{"start":{"row":61,"column":25},"end":{"row":61,"column":26},"action":"remove","lines":["a"]}],[{"start":{"row":61,"column":25},"end":{"row":61,"column":26},"action":"insert","lines":["e"],"id":17},{"start":{"row":61,"column":26},"end":{"row":61,"column":27},"action":"insert","lines":["x"]},{"start":{"row":61,"column":27},"end":{"row":61,"column":28},"action":"insert","lines":["p"]},{"start":{"row":61,"column":28},"end":{"row":61,"column":29},"action":"insert","lines":["e"]},{"start":{"row":61,"column":29},"end":{"row":61,"column":30},"action":"insert","lines":["c"]},{"start":{"row":61,"column":30},"end":{"row":61,"column":31},"action":"insert","lines":["t"]},{"start":{"row":61,"column":31},"end":{"row":61,"column":32},"action":"insert","lines":["e"]},{"start":{"row":61,"column":32},"end":{"row":61,"column":33},"action":"insert","lines":["d"]}],[{"start":{"row":61,"column":33},"end":{"row":61,"column":34},"action":"insert","lines":[" "],"id":18},{"start":{"row":61,"column":34},"end":{"row":61,"column":35},"action":"insert","lines":["r"]},{"start":{"row":61,"column":35},"end":{"row":61,"column":36},"action":"insert","lines":["e"]},{"start":{"row":61,"column":36},"end":{"row":61,"column":37},"action":"insert","lines":["s"]},{"start":{"row":61,"column":37},"end":{"row":61,"column":38},"action":"insert","lines":["u"]},{"start":{"row":61,"column":38},"end":{"row":61,"column":39},"action":"insert","lines":["l"]},{"start":{"row":61,"column":39},"end":{"row":61,"column":40},"action":"insert","lines":["t"]}],[{"start":{"row":61,"column":40},"end":{"row":61,"column":41},"action":"insert","lines":["s"],"id":19}]]},"ace":{"folds":[],"scrolltop":0,"scrollleft":0,"selection":{"start":{"row":27,"column":12},"end":{"row":27,"column":78},"isBackwards":true},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":0},"timestamp":1523643186036,"hash":"77e67890a1549966e313b38c389bf80fca34c443"}